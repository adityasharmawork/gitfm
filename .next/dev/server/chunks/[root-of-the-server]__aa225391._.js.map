{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///home/popos/Downloads/code-synth-2025-app%20%281%29/lib/session.ts"],"sourcesContent":["import crypto from \"crypto\"\n\n// Use a secret key from environment variable (must be 32 bytes for AES-256)\nconst getSecretKey = (): Buffer => {\n    const secret = process.env.SESSION_SECRET\n    if (!secret) {\n        throw new Error(\"SESSION_SECRET environment variable is required\")\n    }\n    // Create a consistent 32-byte key from the secret\n    return crypto.createHash(\"sha256\").update(secret).digest()\n}\n\nconst ALGORITHM = \"aes-256-gcm\"\nconst IV_LENGTH = 16\nconst AUTH_TAG_LENGTH = 16\n\nexport function encryptSession(data: object): string {\n    const key = getSecretKey()\n    const iv = crypto.randomBytes(IV_LENGTH)\n    const cipher = crypto.createCipheriv(ALGORITHM, key, iv)\n\n    const jsonData = JSON.stringify(data)\n    const encrypted = Buffer.concat([cipher.update(jsonData, \"utf8\"), cipher.final()])\n    const authTag = cipher.getAuthTag()\n\n    // Combine IV + AuthTag + Encrypted data, then base64 encode\n    const combined = Buffer.concat([iv, authTag, encrypted])\n    return combined.toString(\"base64\")\n}\n\nexport function decryptSession<T = unknown>(encryptedData: string): T | null {\n    try {\n        const key = getSecretKey()\n        const combined = Buffer.from(encryptedData, \"base64\")\n\n        // Extract IV, AuthTag, and encrypted data\n        const iv = combined.subarray(0, IV_LENGTH)\n        const authTag = combined.subarray(IV_LENGTH, IV_LENGTH + AUTH_TAG_LENGTH)\n        const encrypted = combined.subarray(IV_LENGTH + AUTH_TAG_LENGTH)\n\n        const decipher = crypto.createDecipheriv(ALGORITHM, key, iv)\n        decipher.setAuthTag(authTag)\n\n        const decrypted = Buffer.concat([decipher.update(encrypted), decipher.final()])\n        return JSON.parse(decrypted.toString(\"utf8\")) as T\n    } catch (error) {\n        console.error(\"Session decryption failed:\", error)\n        return null\n    }\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,4EAA4E;AAC5E,MAAM,eAAe;IACjB,MAAM,SAAS,QAAQ,GAAG,CAAC,cAAc;IACzC,IAAI,CAAC,QAAQ;QACT,MAAM,IAAI,MAAM;IACpB;IACA,kDAAkD;IAClD,OAAO,gHAAM,CAAC,UAAU,CAAC,UAAU,MAAM,CAAC,QAAQ,MAAM;AAC5D;AAEA,MAAM,YAAY;AAClB,MAAM,YAAY;AAClB,MAAM,kBAAkB;AAEjB,SAAS,eAAe,IAAY;IACvC,MAAM,MAAM;IACZ,MAAM,KAAK,gHAAM,CAAC,WAAW,CAAC;IAC9B,MAAM,SAAS,gHAAM,CAAC,cAAc,CAAC,WAAW,KAAK;IAErD,MAAM,WAAW,KAAK,SAAS,CAAC;IAChC,MAAM,YAAY,OAAO,MAAM,CAAC;QAAC,OAAO,MAAM,CAAC,UAAU;QAAS,OAAO,KAAK;KAAG;IACjF,MAAM,UAAU,OAAO,UAAU;IAEjC,4DAA4D;IAC5D,MAAM,WAAW,OAAO,MAAM,CAAC;QAAC;QAAI;QAAS;KAAU;IACvD,OAAO,SAAS,QAAQ,CAAC;AAC7B;AAEO,SAAS,eAA4B,aAAqB;IAC7D,IAAI;QACA,MAAM,MAAM;QACZ,MAAM,WAAW,OAAO,IAAI,CAAC,eAAe;QAE5C,0CAA0C;QAC1C,MAAM,KAAK,SAAS,QAAQ,CAAC,GAAG;QAChC,MAAM,UAAU,SAAS,QAAQ,CAAC,WAAW,YAAY;QACzD,MAAM,YAAY,SAAS,QAAQ,CAAC,YAAY;QAEhD,MAAM,WAAW,gHAAM,CAAC,gBAAgB,CAAC,WAAW,KAAK;QACzD,SAAS,UAAU,CAAC;QAEpB,MAAM,YAAY,OAAO,MAAM,CAAC;YAAC,SAAS,MAAM,CAAC;YAAY,SAAS,KAAK;SAAG;QAC9E,OAAO,KAAK,KAAK,CAAC,UAAU,QAAQ,CAAC;IACzC,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO;IACX;AACJ"}},
    {"offset": {"line": 114, "column": 0}, "map": {"version":3,"sources":["file:///home/popos/Downloads/code-synth-2025-app%20%281%29/app/api/github/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\nimport type { GitHubData, Repository, LanguageStats, ContributionCalendar } from \"@/lib/types\"\nimport { decryptSession } from \"@/lib/session\"\n\ninterface SessionData {\n  accessToken: string\n  username: string\n  avatarUrl: string\n  name: string | null\n}\n\nconst GITHUB_GRAPHQL_URL = \"https://api.github.com/graphql\"\nconst GITHUB_REST_URL = \"https://api.github.com\"\n\nconst query = `\nquery($username: String!, $from: DateTime!, $to: DateTime!) {\n  user(login: $username) {\n    login\n    name\n    avatarUrl\n    bio\n    followers { totalCount }\n    following { totalCount }\n    repositories(ownerAffiliations: OWNER) { totalCount }\n    createdAt\n    contributionsCollection(from: $from, to: $to) {\n      contributionCalendar {\n        totalContributions\n        weeks {\n          contributionDays {\n            contributionCount\n            date\n            color\n          }\n        }\n      }\n      totalCommitContributions\n      totalPullRequestContributions\n      totalPullRequestReviewContributions\n      totalIssueContributions\n      totalRepositoryContributions\n      restrictedContributionsCount\n      commitContributionsByRepository(maxRepositories: 100) {\n        repository {\n          name\n          nameWithOwner\n          isFork\n          stargazerCount\n          forkCount\n          primaryLanguage {\n            name\n            color\n          }\n        }\n        contributions {\n          totalCount\n        }\n      }\n    }\n    pullRequests(first: 100, states: MERGED, orderBy: {field: CREATED_AT, direction: DESC}) {\n      totalCount\n      nodes {\n        repository {\n          name\n        }\n      }\n    }\n    issues(first: 1) {\n      totalCount\n    }\n    issueComments(first: 1) {\n      totalCount\n    }\n    starredRepositories {\n      totalCount\n    }\n    topRepositories: repositories(first: 20, orderBy: {field: STARGAZERS, direction: DESC}, ownerAffiliations: OWNER) {\n      nodes {\n        name\n        languages(first: 10, orderBy: {field: SIZE, direction: DESC}) {\n          edges {\n            size\n            node {\n              name\n              color\n            }\n          }\n        }\n      }\n    }\n  }\n}\n`\n\nasync function fetchGitHubDataAuthenticated(username: string, token: string): Promise<GitHubData> {\n  const now = new Date()\n  const startOfYear = new Date(now.getFullYear(), 0, 1)\n\n  const response = await fetch(GITHUB_GRAPHQL_URL, {\n    method: \"POST\",\n    headers: {\n      Authorization: `Bearer ${token}`,\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      query,\n      variables: {\n        username,\n        from: startOfYear.toISOString(),\n        to: now.toISOString(),\n      },\n    }),\n  })\n\n  if (!response.ok) {\n    const errorText = await response.text()\n    throw new Error(`GitHub API error: ${response.status} - ${errorText}`)\n  }\n\n  const data = await response.json()\n\n  if (data.errors) {\n    throw new Error(data.errors[0]?.message || \"GraphQL query failed\")\n  }\n\n  if (!data.data?.user) {\n    throw new Error(\"User not found\")\n  }\n\n  return processGraphQLResponse(data.data.user)\n}\n\nasync function fetchContributionCalendar(\n  username: string,\n): Promise<{ calendar: ContributionCalendar; totalContributions: number }> {\n  const year = new Date().getFullYear()\n\n  // GitHub provides a public endpoint for contribution data\n  const response = await fetch(\n    `https://github.com/users/${encodeURIComponent(username)}/contributions?from=${year}-01-01&to=${year}-12-31`,\n    {\n      headers: {\n        Accept: \"text/html\",\n        \"User-Agent\": \"CodeSynth-2025\",\n      },\n    },\n  )\n\n  if (!response.ok) {\n    // Fallback to empty calendar if fetch fails\n    return { calendar: { totalContributions: 0, weeks: [] }, totalContributions: 0 }\n  }\n\n  const html = await response.text()\n\n  // Parse contribution data from the HTML response\n  const contributionDays: { date: string; count: number; color: string }[] = []\n\n  // Match data-date and data-level attributes from the SVG\n  const dayRegex = /data-date=\"([^\"]+)\"[^>]*data-level=\"(\\d+)\"/g\n  let match\n\n  while ((match = dayRegex.exec(html)) !== null) {\n    const date = match[1]\n    const level = Number.parseInt(match[2], 10)\n\n    // Only include 2025 dates\n    if (date.startsWith(`${year}`)) {\n      contributionDays.push({\n        date,\n        count: levelToCount(level),\n        color: levelToColor(level),\n      })\n    }\n  }\n\n  // Also try to extract total contributions\n  const totalMatch = html.match(/(\\d{1,3}(?:,\\d{3})*)\\s+contributions?\\s+in\\s+(?:the\\s+last\\s+year|${year})/i)\n  let totalFromPage = 0\n  if (totalMatch) {\n    totalFromPage = Number.parseInt(totalMatch[1].replace(/,/g, \"\"), 10)\n  }\n\n  // Build weeks array\n  const weeks = buildWeeksFromDays(contributionDays, year)\n  const calculatedTotal = contributionDays.reduce((sum, d) => sum + d.count, 0)\n\n  return {\n    calendar: {\n      totalContributions: totalFromPage || calculatedTotal,\n      weeks,\n    },\n    totalContributions: totalFromPage || calculatedTotal,\n  }\n}\n\nfunction levelToCount(level: number): number {\n  // GitHub uses levels 0-4, we convert back to approximate counts\n  switch (level) {\n    case 0:\n      return 0\n    case 1:\n      return 2\n    case 2:\n      return 5\n    case 3:\n      return 10\n    case 4:\n      return 15\n    default:\n      return 0\n  }\n}\n\nfunction levelToColor(level: number): string {\n  switch (level) {\n    case 0:\n      return \"#161b22\"\n    case 1:\n      return \"#0e4429\"\n    case 2:\n      return \"#006d32\"\n    case 3:\n      return \"#26a641\"\n    case 4:\n      return \"#39d353\"\n    default:\n      return \"#161b22\"\n  }\n}\n\nfunction buildWeeksFromDays(days: { date: string; count: number; color: string }[], year: number) {\n  // Sort days by date\n  days.sort((a, b) => a.date.localeCompare(b.date))\n\n  const weeks: { contributionDays: { contributionCount: number; date: string; color: string }[] }[] = []\n  let currentWeek: { contributionCount: number; date: string; color: string }[] = []\n\n  // Create a map for quick lookup\n  const dayMap = new Map(days.map((d) => [d.date, d]))\n\n  // Start from Jan 1\n  const startDate = new Date(year, 0, 1)\n  const endDate = new Date()\n\n  // Pad to start on Sunday\n  const startDay = startDate.getDay()\n  for (let i = 0; i < startDay; i++) {\n    currentWeek.push({ contributionCount: 0, date: \"\", color: \"#161b22\" })\n  }\n\n  const current = new Date(startDate)\n  while (current <= endDate) {\n    const dateStr = current.toISOString().split(\"T\")[0]\n    const dayData = dayMap.get(dateStr)\n\n    currentWeek.push({\n      contributionCount: dayData?.count || 0,\n      date: dateStr,\n      color: dayData?.color || \"#161b22\",\n    })\n\n    if (currentWeek.length === 7) {\n      weeks.push({ contributionDays: currentWeek })\n      currentWeek = []\n    }\n\n    current.setDate(current.getDate() + 1)\n  }\n\n  if (currentWeek.length > 0) {\n    weeks.push({ contributionDays: currentWeek })\n  }\n\n  return weeks\n}\n\nfunction processGraphQLResponse(user: any): GitHubData {\n  // Build a map of user's commits per repository from contributionsByRepository\n  const userCommitsByRepo = new Map<string, number>()\n  const repoDetailsMap = new Map<string, any>()\n\n  user.contributionsCollection.commitContributionsByRepository?.forEach((item: any) => {\n    const repoName = item.repository.name\n    userCommitsByRepo.set(repoName, item.contributions.totalCount)\n    repoDetailsMap.set(repoName, item.repository)\n  })\n\n  // Build PR counts per repository\n  const prCountsByRepo = new Map<string, number>()\n  user.pullRequests?.nodes?.forEach((pr: any) => {\n    if (pr.repository?.name) {\n      prCountsByRepo.set(pr.repository.name, (prCountsByRepo.get(pr.repository.name) || 0) + 1)\n    }\n  })\n\n  // Process repositories - only include repos where user has actually contributed\n  const repositories: Repository[] = []\n\n  userCommitsByRepo.forEach((commits, repoName) => {\n    const repoDetails = repoDetailsMap.get(repoName)\n    if (repoDetails && commits > 0) {\n      repositories.push({\n        name: repoName,\n        stars: repoDetails.stargazerCount || 0,\n        commits: commits, // User's commits only!\n        prs: prCountsByRepo.get(repoName) || 0,\n        language: repoDetails.primaryLanguage?.name || null,\n        forks: repoDetails.forkCount || 0,\n        isFork: repoDetails.isFork || false,\n      })\n    }\n  })\n\n  // Sort by user's commits descending\n  repositories.sort((a, b) => b.commits - a.commits)\n\n  // Aggregate languages\n  const languageMap = new Map<string, { size: number; color: string }>()\n\n  user.topRepositories.nodes.forEach((repo: any) => {\n    repo.languages?.edges?.forEach((edge: any) => {\n      const name = edge.node.name\n      const existing = languageMap.get(name)\n      if (existing) {\n        existing.size += edge.size\n      } else {\n        languageMap.set(name, { size: edge.size, color: edge.node.color || \"#888888\" })\n      }\n    })\n  })\n\n  const languages: LanguageStats[] = Array.from(languageMap.entries())\n    .map(([name, { size, color }]) => ({ name, size, color }))\n    .sort((a, b) => b.size - a.size)\n\n  // Calculate totals\n  const totalStarsEarned = repositories.reduce((sum, repo) => sum + repo.stars, 0)\n  const totalForksEarned = repositories.reduce((sum, repo) => sum + (repo.forks || 0), 0)\n  const totalCommits = user.contributionsCollection.totalCommitContributions\n  const totalPRsMerged = user.pullRequests?.totalCount || 0\n  const totalPRsOpened = user.contributionsCollection.totalPullRequestContributions\n  const totalIssuesOpened = user.contributionsCollection.totalIssueContributions\n  const totalIssuesClosed = user.issues?.totalCount || 0\n\n  // Calculate streaks\n  const { longestStreak, currentStreak, mostActiveDay } = calculateStreaks(\n    user.contributionsCollection.contributionCalendar as ContributionCalendar,\n  )\n\n  // Find most active repo (by user's commits)\n  const mostActiveRepo = repositories[0]?.name || null\n\n  return {\n    user: {\n      login: user.login,\n      name: user.name,\n      avatarUrl: user.avatarUrl,\n      bio: user.bio,\n      followers: user.followers?.totalCount || 0,\n      following: user.following?.totalCount || 0,\n      publicRepos: user.repositories?.totalCount || 0,\n      createdAt: user.createdAt,\n    },\n    totalContributions: user.contributionsCollection.contributionCalendar.totalContributions,\n    contributionCalendar: user.contributionsCollection.contributionCalendar as ContributionCalendar,\n    repositories,\n    languages,\n    topLanguage: languages[0]?.name || null,\n    totalPRsMerged,\n    totalPRsOpened,\n    totalIssuesOpened,\n    totalIssuesClosed,\n    totalStarsEarned,\n    totalStarsGiven: user.starredRepositories?.totalCount || 0,\n    totalForksEarned,\n    totalCommits,\n    longestStreak,\n    currentStreak,\n    mostActiveDay,\n    mostActiveRepo,\n  }\n}\n\nasync function fetchGitHubDataPublic(username: string): Promise<GitHubData> {\n  const cleanUsername = username.trim()\n\n  if (!cleanUsername || !/^[a-zA-Z0-9](?:[a-zA-Z0-9]|-(?=[a-zA-Z0-9])){0,38}$/.test(cleanUsername)) {\n    throw new Error(\"Invalid GitHub username format\")\n  }\n\n  // Fetch multiple endpoints in parallel\n  const [userResponse, reposResponse, contributionData, eventsResponse, starredResponse] = await Promise.all([\n    fetch(`${GITHUB_REST_URL}/users/${encodeURIComponent(cleanUsername)}`, {\n      headers: {\n        Accept: \"application/vnd.github.v3+json\",\n        \"User-Agent\": \"CodeSynth-2025\",\n      },\n    }),\n    fetch(\n      `${GITHUB_REST_URL}/users/${encodeURIComponent(cleanUsername)}/repos?sort=stars&direction=desc&per_page=100`,\n      {\n        headers: {\n          Accept: \"application/vnd.github.v3+json\",\n          \"User-Agent\": \"CodeSynth-2025\",\n        },\n      },\n    ),\n    fetchContributionCalendar(cleanUsername),\n    fetch(`${GITHUB_REST_URL}/users/${encodeURIComponent(cleanUsername)}/events/public?per_page=100`, {\n      headers: {\n        Accept: \"application/vnd.github.v3+json\",\n        \"User-Agent\": \"CodeSynth-2025\",\n      },\n    }),\n    fetch(`${GITHUB_REST_URL}/users/${encodeURIComponent(cleanUsername)}/starred?per_page=1`, {\n      headers: {\n        Accept: \"application/vnd.github.v3+json\",\n        \"User-Agent\": \"CodeSynth-2025\",\n      },\n    }),\n  ])\n\n  if (!userResponse.ok) {\n    if (userResponse.status === 404) {\n      throw new Error(`GitHub user \"${cleanUsername}\" not found. Please check the username and try again.`)\n    }\n    if (userResponse.status === 403) {\n      throw new Error(\"Rate limit exceeded. Please sign in with GitHub for unlimited access.\")\n    }\n    const errorBody = await userResponse.text()\n    throw new Error(`GitHub API error: ${userResponse.status} - ${errorBody}`)\n  }\n\n  const userData = await userResponse.json()\n\n  if (!reposResponse.ok) {\n    if (reposResponse.status === 403) {\n      throw new Error(\"Rate limit exceeded. Please sign in with GitHub for unlimited access.\")\n    }\n    throw new Error(`Failed to fetch repositories: ${reposResponse.status}`)\n  }\n\n  const reposData = await reposResponse.json()\n\n  let eventsData: any[] = []\n  if (eventsResponse.ok) {\n    eventsData = await eventsResponse.json()\n  }\n\n  // Get starred count from Link header\n  let starredCount = 0\n  if (starredResponse.ok) {\n    const linkHeader = starredResponse.headers.get(\"Link\")\n    if (linkHeader) {\n      const lastMatch = linkHeader.match(/page=(\\d+)>; rel=\"last\"/)\n      if (lastMatch) {\n        starredCount = Number.parseInt(lastMatch[1], 10)\n      }\n    } else {\n      const starredData = await starredResponse.json()\n      starredCount = Array.isArray(starredData) ? starredData.length : 0\n    }\n  }\n\n  // Count user's commits per repo from events (this is user's activity only)\n  const repoCommitCounts = new Map<string, number>()\n  eventsData.forEach((event: any) => {\n    if (event.type === \"PushEvent\") {\n      const repoName = event.repo?.name?.split(\"/\")[1]\n      if (repoName) {\n        const commits = event.payload?.commits?.length || 0\n        repoCommitCounts.set(repoName, (repoCommitCounts.get(repoName) || 0) + commits)\n      }\n    }\n  })\n\n  // Count PRs per repo from events\n  const repoPRCounts = new Map<string, number>()\n  eventsData.forEach((event: any) => {\n    if (event.type === \"PullRequestEvent\") {\n      const repoName = event.repo?.name?.split(\"/\")[1]\n      if (repoName) {\n        repoPRCounts.set(repoName, (repoPRCounts.get(repoName) || 0) + 1)\n      }\n    }\n  })\n\n  // Build repositories list - only include user's own repos, not forks, unless user has commits in them\n  const repositories: Repository[] = reposData\n    .filter((repo: any) => {\n      // Include if not a fork, or if user has commits in the fork (from events)\n      if (!repo.fork) return true\n      return repoCommitCounts.has(repo.name) && (repoCommitCounts.get(repo.name) || 0) > 0\n    })\n    .map((repo: any) => {\n      const userCommits = repoCommitCounts.get(repo.name) || 0\n      // For non-forked repos owned by user, estimate commits if no events data\n      // For forked repos, only use actual event commits (0 if none)\n      const commits = repo.fork ? userCommits : userCommits || Math.ceil(repo.size / 100) // Smaller estimate for owned repos\n\n      return {\n        name: repo.name,\n        stars: repo.stargazers_count || 0,\n        commits: commits,\n        prs: repoPRCounts.get(repo.name) || 0,\n        language: repo.language || null,\n        forks: repo.forks_count || 0,\n        isFork: repo.fork || false,\n      }\n    })\n\n  // Sort by commits (user's activity)\n  repositories.sort((a, b) => b.commits - a.commits)\n\n  // Aggregate languages from repositories (only from non-forked or actively contributed repos)\n  const languageMap = new Map<string, { size: number; color: string }>()\n  const languageColors: Record<string, string> = {\n    JavaScript: \"#f1e05a\",\n    TypeScript: \"#3178c6\",\n    Python: \"#3572A5\",\n    Java: \"#b07219\",\n    Go: \"#00ADD8\",\n    Rust: \"#dea584\",\n    Ruby: \"#701516\",\n    PHP: \"#4F5D95\",\n    \"C++\": \"#f34b7d\",\n    C: \"#555555\",\n    \"C#\": \"#178600\",\n    Swift: \"#F05138\",\n    Kotlin: \"#A97BFF\",\n    Dart: \"#00B4AB\",\n    Vue: \"#41b883\",\n    HTML: \"#e34c26\",\n    CSS: \"#563d7c\",\n    Shell: \"#89e051\",\n    Scala: \"#c22d40\",\n  }\n\n  repositories.forEach((repo) => {\n    if (repo.language) {\n      const existing = languageMap.get(repo.language)\n      // Weight by commits to reflect actual usage\n      const weight = repo.commits || 1\n      if (existing) {\n        existing.size += weight\n      } else {\n        languageMap.set(repo.language, {\n          size: weight,\n          color: languageColors[repo.language] || \"#888888\",\n        })\n      }\n    }\n  })\n\n  const languages: LanguageStats[] = Array.from(languageMap.entries())\n    .map(([name, { size, color }]) => ({ name, size, color }))\n    .sort((a, b) => b.size - a.size)\n\n  // Count events by type\n  const pushEvents = eventsData.filter((e: any) => e.type === \"PushEvent\")\n  const prEvents = eventsData.filter((e: any) => e.type === \"PullRequestEvent\")\n  const issueEvents = eventsData.filter((e: any) => e.type === \"IssuesEvent\")\n\n  const commitsFromEvents = pushEvents.reduce((sum: number, e: any) => {\n    return sum + (e.payload?.commits?.length || 0)\n  }, 0)\n\n  const prsOpened = prEvents.filter((e: any) => e.payload?.action === \"opened\").length\n  const prsMerged = prEvents.filter(\n    (e: any) => e.payload?.action === \"closed\" && e.payload?.pull_request?.merged,\n  ).length\n\n  const issuesOpened = issueEvents.filter((e: any) => e.payload?.action === \"opened\").length\n  const issuesClosed = issueEvents.filter((e: any) => e.payload?.action === \"closed\").length\n\n  // Calculate streaks from contribution calendar\n  const { longestStreak, currentStreak, mostActiveDay } = calculateStreaks(contributionData.calendar)\n\n  // Calculate total stars from non-forked repos only\n  const totalStarsEarned = repositories.filter((r) => !r.isFork).reduce((sum, repo) => sum + repo.stars, 0)\n\n  const totalForksEarned = repositories.filter((r) => !r.isFork).reduce((sum, repo) => sum + (repo.forks || 0), 0)\n\n  return {\n    user: {\n      login: userData.login,\n      name: userData.name,\n      avatarUrl: userData.avatar_url,\n      bio: userData.bio,\n      followers: userData.followers || 0,\n      following: userData.following || 0,\n      publicRepos: userData.public_repos || 0,\n      createdAt: userData.created_at,\n    },\n    totalContributions: contributionData.totalContributions,\n    contributionCalendar: contributionData.calendar,\n    repositories,\n    languages,\n    topLanguage: languages[0]?.name || null,\n    totalPRsMerged: prsMerged,\n    totalPRsOpened: prsOpened,\n    totalIssuesOpened: issuesOpened,\n    totalIssuesClosed: issuesClosed,\n    totalStarsEarned,\n    totalStarsGiven: starredCount,\n    totalForksEarned,\n    totalCommits: commitsFromEvents || Math.round(contributionData.totalContributions * 0.7),\n    longestStreak,\n    currentStreak,\n    mostActiveDay,\n    mostActiveRepo: repositories[0]?.name || null,\n  }\n}\n\nfunction calculateStreaks(calendar: ContributionCalendar): {\n  longestStreak: number\n  currentStreak: number\n  mostActiveDay: string | null\n} {\n  const allDays: { date: string; count: number }[] = []\n  const dayCounts: Record<string, number> = {\n    Sunday: 0,\n    Monday: 0,\n    Tuesday: 0,\n    Wednesday: 0,\n    Thursday: 0,\n    Friday: 0,\n    Saturday: 0,\n  }\n  const dayNames = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"]\n\n  calendar.weeks.forEach((week) => {\n    week.contributionDays.forEach((day) => {\n      if (day.date) {\n        allDays.push({ date: day.date, count: day.contributionCount })\n        const dayOfWeek = new Date(day.date).getDay()\n        dayCounts[dayNames[dayOfWeek]] += day.contributionCount\n      }\n    })\n  })\n\n  // Sort by date\n  allDays.sort((a, b) => a.date.localeCompare(b.date))\n\n  let longestStreak = 0\n  let currentStreak = 0\n  let tempStreak = 0\n\n  for (let i = 0; i < allDays.length; i++) {\n    if (allDays[i].count > 0) {\n      tempStreak++\n      longestStreak = Math.max(longestStreak, tempStreak)\n    } else {\n      tempStreak = 0\n    }\n  }\n\n  // Calculate current streak (from today backwards)\n  for (let i = allDays.length - 1; i >= 0; i--) {\n    if (allDays[i].count > 0) {\n      currentStreak++\n    } else {\n      break\n    }\n  }\n\n  // Find most active day\n  const mostActiveDay = Object.entries(dayCounts).sort((a, b) => b[1] - a[1])[0]?.[0] || null\n\n  return { longestStreak, currentStreak, mostActiveDay }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json()\n    const { username, useOAuth } = body\n\n    const cleanUsername = username?.trim()\n\n    if (!cleanUsername) {\n      return NextResponse.json({ error: \"Username is required\" }, { status: 400 })\n    }\n\n    // If useOAuth is true, try to use authenticated API with encrypted session\n    if (useOAuth) {\n      const sessionCookie = request.cookies.get(\"github_session\")?.value\n\n      if (!sessionCookie) {\n        return NextResponse.json({ error: \"Not authenticated. Please sign in with GitHub.\" }, { status: 401 })\n      }\n\n      const sessionData = decryptSession<SessionData>(sessionCookie)\n\n      if (!sessionData || !sessionData.accessToken) {\n        return NextResponse.json({ error: \"Invalid session. Please sign in again.\" }, { status: 401 })\n      }\n\n      // SECURITY: Only allow using the access token if the user is requesting their OWN data\n      // This prevents using one user's token to fetch detailed stats for another user\n      if (sessionData.username.toLowerCase() === cleanUsername.toLowerCase()) {\n        const data = await fetchGitHubDataAuthenticated(cleanUsername, sessionData.accessToken)\n        return NextResponse.json(data)\n      } else {\n        // If requesting someone else's profile, fall back to public data\n        // This ensures \"High Fidelity\" mode is strictly for the owner\n        const data = await fetchGitHubDataPublic(cleanUsername)\n        return NextResponse.json(data)\n      }\n    } else {\n      // Use public API for non-authenticated requests\n      const data = await fetchGitHubDataPublic(cleanUsername)\n      return NextResponse.json(data)\n    }\n  } catch (error) {\n    console.error(\"GitHub API Error:\", error)\n    return NextResponse.json(\n      { error: error instanceof Error ? error.message : \"Failed to fetch GitHub data\" },\n      { status: 500 },\n    )\n  }\n}\n\n"],"names":[],"mappings":"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"}}]
}